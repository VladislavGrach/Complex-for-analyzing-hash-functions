@model Complex_for_analyzing_hash_functions.Models.HashTestParameters

@{
    ViewData["Title"] = "Параметры тестирования";
}

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:opsz,wght@14..32,400;14..32,500;14..32,600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="~/css/results.css">
<link rel="stylesheet" href="~/css/forms.css">

<div class="container py-5">
    <!-- Заголовок и подзаголовок над карточкой -->
    <div class="text-center mb-5">
        <h2 class="mb-2">Параметры тестирования</h2>
        <p class="text-muted mb-0">
            Задайте параметры серии экспериментов и запустите вычисление хэш-значений.
        </p>
    </div>

    <div class="row justify-content-center">
        <div class="col-lg-6 col-xl-5">
            <div class="card shadow-sm form-card">
                <div class="card-body">
                    <form asp-action="Run" method="post" id="hashTestForm">
                        <div asp-validation-summary="All" class="text-danger small mb-3"></div>

                        <div class="mb-3">
                            <label asp-for="TestsCount" class="form-label">Количество тестов</label>
                            <input asp-for="TestsCount" class="form-control" type="number" min="1" value="1" />
                            <span asp-validation-for="TestsCount" class="text-danger small"></span>
                        </div>

                        <div class="mb-3">
                            <label asp-for="InputSizeBytes" class="form-label">Размер входных данных (байт)</label>
                            <input asp-for="InputSizeBytes" class="form-control" type="number" min="1" value="32" />
                            <span asp-validation-for="InputSizeBytes" class="text-danger small"></span>
                        </div>

                        <div class="mb-3">
                            <label asp-for="Rounds" class="form-label">Число раундов</label>
                            <input asp-for="Rounds" class="form-control" type="number" min="1" value="8" />
                            <span asp-validation-for="Rounds" class="text-danger small"></span>
                        </div>

                        <div class="mb-4">
                            <label asp-for="Algorithm" class="form-label">Алгоритм</label>
                            <select asp-for="Algorithm" class="form-select">
                                <option value="Keccak">Keccak</option>
                                <option value="Blake">BLAKE-256</option>
                                <option value="Blake2s">BLAKE2s-256</option>
                                <option value="Blake2b">BLAKE2b-256</option>
                                <option value="Blake3">BLAKE3-256</option>
                            </select>
                            <span asp-validation-for="Algorithm" class="text-danger small"></span>
                        </div>

                        <div class="d-flex justify-content-center">
                            <button type="submit" class="btn btn-primary" id="runBtn">
                                Запустить тестирование
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Оверлей "идет выполнение" -->
<div id="loadingOverlay"
     class="position-fixed top-0 start-0 w-100 h-100 d-none"
     style="background: rgba(0,0,0,.35); z-index: 2000;">
    <div class="position-absolute top-50 start-50 translate-middle text-center text-white">
        <div class="spinner-border" role="status" aria-hidden="true"></div>
        <div class="mt-3">Идёт тестирование. Пожалуйста, подождите</div>
    </div>
</div>

@section Scripts {
    <script>
        (function () {
          const form = document.getElementById('hashTestForm');
          const overlay = document.getElementById('loadingOverlay');
          const btn = document.getElementById('runBtn');
          if (!form) return;
          form.addEventListener('submit', function () {
            if (overlay) overlay.classList.remove('d-none');
            if (btn) setTimeout(() => btn.disabled = true, 0);
          });
        })();
    </script>
}